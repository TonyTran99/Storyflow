<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>StoryFlow 9 â€“ Kallaway Storytelling Coach (HTML)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="description" content="StoryFlow 9 â€“ Trá»£ lÃ½ ká»ƒ chuyá»‡n theo 9 chiáº¿n thuáº­t Kallaway" />
  <style>
    .prose ul { list-style: disc; padding-left: 1.25rem; }
    .fade-in { animation: fade .25s ease-in; }
    @keyframes fade { from {opacity: .0; transform: translateY(3px)} to {opacity:1; transform: translateY(0)} }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-b from-slate-50 to-slate-100 text-slate-800">
  <!-- Header -->
  <header class="sticky top-0 z-10 bg-white/80 backdrop-blur border-b border-slate-200">
    <div class="mx-auto max-w-6xl px-4 py-4 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="h-9 w-9 rounded-xl bg-slate-900 text-white grid place-items-center font-bold">SF</div>
        <div>
          <h1 class="text-lg md:text-xl font-semibold">StoryFlow 9</h1>
          <p class="text-xs text-slate-500 -mt-0.5">Trá»£ lÃ½ ká»ƒ chuyá»‡n â€“ 9 chiáº¿n thuáº­t vÃ ng (Kallaway)</p>
        </div>
      </div>
      <div class="flex items-center gap-2">
        <button id="copyJsonBtn" class="px-3 py-1.5 rounded-lg bg-slate-900 text-white text-sm hover:opacity-90">Sao chÃ©p JSON</button>
        <button id="resetBtn" className="px-3 py-1.5 rounded-lg border text-sm">Reset</button>
      </div>
    </div>
  </header>

  <main class="mx-auto max-w-6xl px-4 py-8 space-y-8">
    <!-- Controls -->
    <section class="bg-white/80 backdrop-blur rounded-2xl shadow-sm border border-slate-200 p-5 md:p-6">
      <div class="flex items-start gap-3 mb-3">
        <div class="h-9 w-9 shrink-0 rounded-xl bg-slate-900 text-white flex items-center justify-center text-sm font-semibold">âš™ï¸</div>
        <h2 class="text-xl md:text-2xl font-semibold text-slate-800 leading-tight">Thiáº¿t láº­p nhanh</h2>
      </div>

      <div class="grid md:grid-cols-2 gap-5">
        <!-- Chá»§ Ä‘á» video + Máº«u chá»§ Ä‘á» nhanh -->
        <label class="block">
          <div class="text-sm font-medium text-slate-700 mb-1">Chá»§ Ä‘á» video</div>
          <input id="topic" class="w-full rounded-xl border border-slate-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-slate-300" placeholder="AI giÃºp há»c sinh tiá»ƒu há»c há»c ToÃ¡n nhanh hÆ¡n"/>
          <div class="mt-2 grid grid-cols-1 sm:grid-cols-2 gap-3">
            <label class="block">
              <div class="text-xs font-medium text-slate-600 mb-1">Máº«u chá»§ Ä‘á» nhanh</div>
              <select id="topicPreset" class="w-full rounded-xl border border-slate-300 px-3 py-2">
                <!-- 8 vÃ­ dá»¥ Ä‘a lÄ©nh vá»±c -->
                <option value="">â€” Chá»n má»™t vÃ­ dá»¥ â€”</option>
                <option>AI giÃºp há»c sinh tiá»ƒu há»c há»c ToÃ¡n nhanh hÆ¡n</option>
                <option>9 chiáº¿n thuáº­t ká»ƒ chuyá»‡n giÃºp video YouTube tÄƒng giá»¯ chÃ¢n</option>
                <option>HDPE: LÃ³t há»“ tÆ°á»›i tiáº¿t kiá»‡m chi phÃ­ vÃ  chá»‘ng rÃ² rá»‰</option>
                <option>Luáº­t Äáº¥t Ä‘ai 2024: 5 bÆ°á»›c xin cáº¥p sá»• láº§n Ä‘áº§u dá»… hiá»ƒu</option>
                <option>VNIndex & sÃ³ng Elliott: Hai ká»‹ch báº£n 30 ngÃ y tá»›i</option>
                <option>Trump Brand: TÃªn tuá»•i Ä‘Ã¡ng giÃ¡ hÆ¡n vÃ ng?</option>
                <option>Pháº­t phÃ¡p á»©ng dá»¥ng: 3 thÃ³i quen giáº£m cÄƒng tháº³ng má»—i ngÃ y</option>
                <option>Real Estate Quy NhÆ¡n: Chá»n cÄƒn há»™ theo 7 tiÃªu chÃ­ cá»‘t lÃµi</option>
              </select>
            </label>
            <div class="flex items-end">
              <button id="applyTopicPreset" class="px-3 py-2 rounded-xl border border-slate-300 text-sm hover:bg-slate-50 w-full">DÃ¹ng máº«u chá»§ Ä‘á»</button>
            </div>
          </div>
          <div class="text-xs text-slate-500 mt-2">Chá»n tá»« â€œMáº«u chá»§ Ä‘á» nhanhâ€ Ä‘á»ƒ tá»± Ä‘á»™ng Ä‘iá»n â€“ sau Ä‘Ã³ báº¡n váº«n cÃ³ thá»ƒ chá»‰nh sá»­a.</div>
        </label>

        <!-- Äá»‘i tÆ°á»£ng chÃ­nh + Máº«u Ä‘á»‘i tÆ°á»£ng nhanh -->
        <label class="block">
          <div class="text-sm font-medium text-slate-700 mb-1">Äá»‘i tÆ°á»£ng chÃ­nh</div>
          <select id="audience" class="w-full rounded-xl border border-slate-300 px-3 py-2">
            <!-- 8 vÃ­ dá»¥ Ä‘á»‘i tÆ°á»£ng -->
            <option>Phá»¥ huynh cÃ³ con cáº¥p 1</option>
            <option>NgÆ°á»i má»›i há»c AI</option>
            <option>NhÃ  Ä‘áº§u tÆ° ná»™i dung</option>
            <option>Há»c sinh THCS</option>
            <option>NhÃ  Ä‘áº§u tÆ° chá»©ng khoÃ¡n cÃ¡ nhÃ¢n</option>
            <option>KhÃ¡ch hÃ ng báº¥t Ä‘á»™ng sáº£n Quy NhÆ¡n</option>
            <option>KhÃ¡ch hÃ ng cáº§n giáº£i phÃ¡p mÃ ng chá»‘ng tháº¥m HDPE</option>
            <option>NgÆ°á»i quan tÃ¢m phÃ¡t triá»ƒn báº£n thÃ¢n & Pháº­t phÃ¡p</option>
          </select>

          <div class="mt-2 grid grid-cols-1 sm:grid-cols-2 gap-3">
            <label class="block">
              <div class="text-xs font-medium text-slate-600 mb-1">Máº«u Ä‘á»‘i tÆ°á»£ng nhanh</div>
              <select id="audiencePreset" class="w-full rounded-xl border border-slate-300 px-3 py-2">
                <option value="">â€” Chá»n má»™t vÃ­ dá»¥ â€”</option>
                <option>Phá»¥ huynh cÃ³ con cáº¥p 1</option>
                <option>NgÆ°á»i má»›i há»c AI</option>
                <option>NhÃ  Ä‘áº§u tÆ° chá»©ng khoÃ¡n cÃ¡ nhÃ¢n</option>
                <option>KhÃ¡ch hÃ ng báº¥t Ä‘á»™ng sáº£n Quy NhÆ¡n</option>
                <option>Chá»§ trang tráº¡i/nhÃ  mÃ¡y cáº§n HDPE</option>
                <option>Doanh nhÃ¢n tráº» 20â€“35 tuá»•i</option>
                <option>Phá»¥ huynh quan tÃ¢m an toÃ n sá»‘ cho con</option>
                <option>NgÆ°á»i thá»±c hÃ nh chÃ¡nh niá»‡m</option>
              </select>
            </label>
            <div class="flex items-end">
              <button id="applyAudiencePreset" class="px-3 py-2 rounded-xl border border-slate-300 text-sm hover:bg-slate-50 w-full">DÃ¹ng máº«u Ä‘á»‘i tÆ°á»£ng</button>
            </div>
          </div>
          <div class="text-xs text-slate-500 mt-2">Báº¡n cÃ³ thá»ƒ chá»n nhanh â€œMáº«u Ä‘á»‘i tÆ°á»£ngâ€ rá»“i váº«n chá»‰nh sá»­a trá»±c tiáº¿p.</div>
        </label>

        <label class="block">
          <div class="text-sm font-medium text-slate-700 mb-1">Má»¥c tiÃªu video</div>
          <input id="goal" class="w-full rounded-xl border border-slate-300 px-3 py-2" placeholder="giÃºp khÃ¡n giáº£ Ã¡p dá»¥ng Ä‘Æ°á»£c ngay"/>
        </label>

        <label class="block">
          <div class="text-sm font-medium text-slate-700 mb-1">Ná»n táº£ng / Thá»i lÆ°á»£ng gá»£i Ã½</div>
          <select id="platform" class="w-full rounded-xl border border-slate-300 px-3 py-2">
            <option value="yt">YouTube (8â€“12 phÃºt)</option>
            <option value="shorts" selected>Shorts/Reels (45â€“60s)</option>
            <option value="tiktok">TikTok (60â€“120s)</option>
            <option value="pod">Podcast video (15â€“30p)</option>
          </select>
        </label>

        <label class="block">
          <div class="text-sm font-medium text-slate-700 mb-1">TÃ´ng giá»ng</div>
          <select id="tone" class="w-full rounded-xl border border-slate-300 px-3 py-2">
            <option>áº¤m Ã¡p</option>
            <option>DÃ­ dá»m</option>
            <option>Trá»±c diá»‡n</option>
            <option selected>Truyá»n cáº£m há»©ng</option>
            <option>HÃ i hÆ°á»›c</option>
            <option>Ká»‹ch tÃ­nh</option>
          </select>
        </label>

        <label class="block">
          <div class="text-sm font-medium text-slate-700 mb-1">TÃ i sáº£n báº±ng chá»©ng (phÃ¢n tÃ¡ch báº±ng dáº¥u pháº©y)</div>
          <input id="proofAssets" class="w-full rounded-xl border border-slate-300 px-3 py-2" value="áº¢nh trÆ°á»›c/sau, Feedback khÃ¡ch hÃ ng, Biá»ƒu Ä‘á»“ káº¿t quáº£"/>
          <div class="text-xs text-slate-500 mt-1">VD: áº¢nh trÆ°á»›c/sau, Feedback khÃ¡ch hÃ ng, Biá»ƒu Ä‘á»“ káº¿t quáº£, Video thá»±c hÃ nh</div>
        </label>
      </div>

      <div class="h-px bg-slate-200 my-6"></div>

      <div id="chips" class="flex flex-wrap gap-2 items-center text-sm"></div>

      <div class="mt-6">
        <button id="generateBtn" class="px-4 py-2 rounded-xl bg-slate-900 text-white text-sm hover:opacity-90">Táº¡o gá»£i Ã½ 9 chiáº¿n thuáº­t</button>
      </div>
    </section>

    <!-- Results -->
    <div id="results" class="space-y-6"></div>

    <footer class="text-center text-xs text-slate-500 pt-6 pb-12">StoryFlow 9 â€¢ Kallaway-inspired â€¢ HTML + Tailwind + Vanilla JS</footer>
  </main>

  <script>
    // --- Helpers & Presets ---
    const $ = (id) => document.getElementById(id);

    const topicExamples = [
      "AI giÃºp há»c sinh tiá»ƒu há»c há»c ToÃ¡n nhanh hÆ¡n",
      "9 chiáº¿n thuáº­t ká»ƒ chuyá»‡n giÃºp video YouTube tÄƒng giá»¯ chÃ¢n",
      "HDPE: LÃ³t há»“ tÆ°á»›i tiáº¿t kiá»‡m chi phÃ­ vÃ  chá»‘ng rÃ² rá»‰",
      "Luáº­t Äáº¥t Ä‘ai 2024: 5 bÆ°á»›c xin cáº¥p sá»• láº§n Ä‘áº§u dá»… hiá»ƒu",
      "VNIndex & sÃ³ng Elliott: Hai ká»‹ch báº£n 30 ngÃ y tá»›i",
      "Trump Brand: TÃªn tuá»•i Ä‘Ã¡ng giÃ¡ hÆ¡n vÃ ng?",
      "Pháº­t phÃ¡p á»©ng dá»¥ng: 3 thÃ³i quen giáº£m cÄƒng tháº³ng má»—i ngÃ y",
      "Real Estate Quy NhÆ¡n: Chá»n cÄƒn há»™ theo 7 tiÃªu chÃ­ cá»‘t lÃµi"
    ];

    const audienceExamples = [
      "Phá»¥ huynh cÃ³ con cáº¥p 1",
      "NgÆ°á»i má»›i há»c AI",
      "NhÃ  Ä‘áº§u tÆ° chá»©ng khoÃ¡n cÃ¡ nhÃ¢n",
      "KhÃ¡ch hÃ ng báº¥t Ä‘á»™ng sáº£n Quy NhÆ¡n",
      "Chá»§ trang tráº¡i/nhÃ  mÃ¡y cáº§n HDPE",
      "Doanh nhÃ¢n tráº» 20â€“35 tuá»•i",
      "Phá»¥ huynh quan tÃ¢m an toÃ n sá»‘ cho con",
      "NgÆ°á»i thá»±c hÃ nh chÃ¡nh niá»‡m"
    ];

    const platformSpecs = {
      yt:  { label: "YouTube (8â€“12 phÃºt)", switchSec: 4 },
      shorts: { label: "Shorts/Reels (45â€“60s)", switchSec: 3 },
      tiktok: { label: "TikTok (60â€“120s)", switchSec: 3 },
      pod: { label: "Podcast video (15â€“30p)", switchSec: 6 },
    };

    function sentence(s) {
      const t = (s || "").trim();
      if (!t) return "";
      const last = t.slice(-1);
      return ".!?".includes(last) ? t : t + ".";
    }

    function makeChip(text) {
      const span = document.createElement("span");
      span.className = "inline-flex items-center rounded-full border border-slate-300 px-2.5 py-1 text-xs font-medium text-slate-700 bg-white";
      span.textContent = text;
      return span;
    }

    function sectionCard({badge, title, html}) {
      const wrap = document.createElement("section");
      wrap.className = "bg-white/80 backdrop-blur rounded-2xl shadow-sm border border-slate-200 p-5 md:p-6 fade-in";
      wrap.innerHTML = `
        <div class="flex items-start gap-3 mb-3">
          <div class="h-9 w-9 shrink-0 rounded-xl bg-slate-900 text-white flex items-center justify-center text-sm font-semibold">${badge}</div>
          <h3 class="text-xl md:text-2xl font-semibold text-slate-800 leading-tight">${title}</h3>
        </div>
        <div class="prose prose-slate max-w-none text-sm md:text-base">${html}</div>
      `;
      return wrap;
    }

    function buildEngine(input) {
      const { topic, audience, goal, platform, tone } = input;
      const p = platformSpecs[platform] || platformSpecs.shorts;
      const switchEvery = p.switchSec;

      const compMax = {
        speak: [
          `Trong video hÃ´m nay, chÃºng ta sáº½ nÃ³i vá»: ${topic}`,
          `Má»¥c tiÃªu: ${goal || "giÃºp khÃ¡n giáº£ Ã¡p dá»¥ng Ä‘Æ°á»£c ngay"}`
        ].map(sentence),
        visuals: [
          `Khung má»Ÿ: text Ä‘á»™ng trÃªn mÃ n hÃ¬nh hiá»ƒn thá»‹ chá»§ Ä‘á» "${topic}"`,
          "Cut-in: vÃ­ dá»¥ thá»±c táº¿ 3â€“5 giÃ¢y minh há»a váº¥n Ä‘á»",
          "Overlay tá»« khÃ³a chÃ­nh bÃ¡m theo lá»i nÃ³i (2â€“4 tá»«/slide)"
        ]
      };

      const hawkeye = {
        openContext: sentence(`Váº¥n Ä‘á» lá»›n cá»§a ${audience}: vÃ¬ sao ${topic.toLowerCase()} láº¡i quan trá»ng?`),
        deepen: [
          "Pháº§n 1 â€“ Bá»‘i cáº£nh rá»™ng: dá»¯ liá»‡u/quan sÃ¡t phá»• quÃ¡t",
          "Pháº§n 2 â€“ NguyÃªn lÃ½/lÃ½ thuyáº¿t cá»‘t lÃµi",
          "Pháº§n 3 â€“ VÃ­ dá»¥ cá»¥ thá»ƒ vÃ  cÃ¡ch lÃ m tá»«ng bÆ°á»›c"
        ].map(sentence)
      };

      const metaphors = [
        `${topic} giá»‘ng nhÆ° má»™t â€œgia sÆ° vÃ´ hÃ¬nhâ€ luÃ´n trá»±c 24/7`,
        "DÃ²ng cháº£y cÃ¢u chuyá»‡n nhÆ° thá»§y triá»u: lÃªn â€“ cÄƒng â€“ xáº£ â€“ láº¯ng",
        "Báº£n Ä‘á»“ trÆ°á»›c â€“ Ä‘Æ°á»ng Ä‘i sau: cÃ³ map rá»“i má»›i lÃ¡i xe"
      ];

      const commonGround = {
        opener: sentence("TÃ´i tá»«ng á»Ÿ vá»‹ trÃ­ cá»§a báº¡n: hoang mang, sá»£ con nghiá»‡n mÃ n hÃ¬nh, vÃ  khÃ´ng biáº¿t báº¯t Ä‘áº§u tá»« Ä‘Ã¢u."),
        we: sentence("NhÆ°ng khi chÃºng ta thá»­ má»™t cÃ¡ch tiáº¿p cáº­n má»›i, má»i thá»© báº¯t Ä‘áº§u thay Ä‘á»•i."),
        ref: sentence("Nhá»¯ng vÃ­ dá»¥ Ä‘á»i thá»±c ngay sau Ä‘Ã¢y sáº½ giÃºp chÃºng ta tháº¥y rÃµ.")
      };

      const simplify = [
        "Chia nhá» khÃ¡i niá»‡m thÃ nh 3 Ã½ cá»‘t lÃµi, má»—i Ã½ â‰¤ 1 cÃ¢u ngáº¯n",
        "TrÃ¡nh thuáº­t ngá»¯ â€“ náº¿u buá»™c dÃ¹ng, luÃ´n kÃ¨m vÃ­ dá»¥",
        "DÃ¹ng cÃ¢u chá»§ Ä‘á»™ng, Ä‘á»™ng tá»« máº¡nh, sá»‘ liá»‡u trÃ²n dá»… nhá»›"
      ];

      const visualStun = {
        cadence: sentence(`Äá»•i khung hÃ¬nh má»—i ${switchEvery} giÃ¢y (cáº­n/medium/toÃ n, text, b-roll, mÃ n hÃ¬nh demo).`),
        edits: [
          "Nháº£y cáº¯t theo Ã½ (jump cut) Ä‘á»ƒ nháº¥n nhá»‹p tÆ° duy",
          "Slow Zoom 5â€“8% trÃªn Ä‘oáº¡n giáº£i thÃ­ch quan trá»ng",
          "Insert b-roll minh há»a vÃ­ dá»¥ trÆ°á»›c â€“ sau"
        ]
      };

      const valueCompression = {
        first10s: [
          "NÃ³i lá»£i Ã­ch lá»›n nháº¥t ngay 5â€“10 giÃ¢y Ä‘áº§u",
          "Hiá»ƒn thá»‹ káº¿t quáº£/cuá»‘i Ä‘Æ°á»ng trÆ°á»›c, hÃ nh trÃ¬nh sau"
        ].map(sentence),
        sample: sentence(`â€œChá»‰ má»™t thay Ä‘á»•i nhá» hÃ´m nay, ${audience.toLowerCase()} sáº½ tháº¥y káº¿t quáº£ ngay tuáº§n nÃ y.â€`)
      };

      const proofAssets = (input.proofAssets || "")
        .split(/,\s*/g)
        .filter(Boolean)
        .length ? input.proofAssets.split(/,\s*/g).filter(Boolean)
                : ["áº¢nh trÆ°á»›c/sau", "Feedback khÃ¡ch hÃ ng", "Clip thá»±c hÃ nh", "Sá»‘ liá»‡u tiáº¿n bá»™"];

      const proof = {
        copy: sentence("ÄÆ°a báº±ng chá»©ng tháº­t Ä‘á»ƒ táº¯t â€˜mÃ¡y dÃ² BSâ€™: áº£nh, video, sá»‘ liá»‡u, hÃ³a Ä‘Æ¡n, case study."),
        assets: proofAssets
      };

      const contrast = {
        template: sentence("Ká»³ vá»ng â†’ Báº» ngoáº·t â†’ Giáº£i thÃ­ch táº¡i sao â†’ Lá»£i Ã­ch báº¥t ngá»"),
        hooks: [
          "TÃ´i Ä‘Ã£ sai suá»‘t 3 nÄƒmâ€¦",
          "CÃ¡ch phá»• biáº¿n nháº¥t thá»±c ra láº¡i kÃ©m hiá»‡u quáº£ nháº¥t",
          "Äiá»u khÃ´ng ai nÃ³i cho báº¡n biáº¿tâ€¦"
        ]
      };

      const outline = [
        { part: "Hook (0â€“10s)", content: [valueCompression.sample, contrast.hooks[1], compMax.speak[0]] },
        { part: "Bá»‘i cáº£nh (10â€“30s)", content: [hawkeye.openContext, commonGround.opener] },
        { part: "NguyÃªn lÃ½ (30â€“60s)", content: [metaphors[0], simplify[0]] },
        { part: "CÃ¡ch lÃ m (1â€“3p)", content: ["BÆ°á»›c 1: â€¦", "BÆ°á»›c 2: â€¦", "BÆ°á»›c 3: â€¦"] },
        { part: "Báº±ng chá»©ng (Ä‘an xen)", content: proof.assets },
        { part: "Káº¿t thÃºc/CTA", content: ["Báº¡n sáº½ thá»­ Ä‘iá»u gÃ¬ ngay hÃ´m nay?", "Comment tá»« khÃ³a Ä‘á»ƒ nháº­n template miá»…n phÃ­."] }
      ];

      const thumb = [
        "TiÃªu Ä‘á» 3â€“5 tá»« máº¡nh: â€˜AI LÃ€ GIA SÆ¯?â€™",
        "áº¢nh chÃ­nh: gÆ°Æ¡ng máº·t cáº£m xÃºc + váº­t thá»ƒ áº©n dá»¥ (Ä‘Ã¨n bÃ n, sÃ¡ch má»Ÿ)",
        "Chá»¯ bá»• trá»£ 2â€“3 tá»«: â€˜Nhanh Gáº¥p 3â€™"
      ];

      const broll = [
        "BÃ© há»c cÃ¹ng laptop/ChatGPT",
        "Close-up tay gÃµ bÃ n phÃ­m",
        "Biá»ƒu Ä‘á»“ trÆ°á»›c/sau",
        "Giáº¥y khen/Ä‘iá»ƒm sá»‘"
      ];

      return { compMax, hawkeye, metaphors, commonGround, simplify, visualStun, valueCompression, proof, contrast, outline, thumb, broll, switchEvery, p, tone, topic, audience, goal };
    }

    function ul(items) {
      return `<ul>${items.map(t => `<li>${t}</li>`).join("")}</ul>`;
    }

    function renderAll(engine) {
      const out = $("results");
      out.innerHTML = "";

      // Chips row
      const chips = $("chips");
      chips.innerHTML = "";
      chips.appendChild(makeChip("Chá»§ Ä‘á»: " + engine.topic));
      chips.appendChild(makeChip("Äá»‘i tÆ°á»£ng: " + engine.audience));
      chips.appendChild(makeChip("Má»¥c tiÃªu: " + engine.goal));
      chips.appendChild(makeChip("Ná»n táº£ng: " + engine.p.label));
      chips.appendChild(makeChip("TÃ´ng giá»ng: " + engine.tone));
      chips.appendChild(makeChip("Äá»•i khung hÃ¬nh má»—i " + engine.switchEvery + "s"));

      // Sections
      const sectionCardEl = (badge, title, html) => sectionCard({ badge, title, html });

      out.appendChild(sectionCardEl("1", "Comprehension Maxing â€“ GhÃ©p lá»i nÃ³i vá»›i hÃ¬nh áº£nh",
        `<p class="font-medium">Lá»i thoáº¡i gá»£i Ã½:</p>${ul(engine.compMax.speak.map(s=>"ğŸ—£ï¸ "+s))}
         <div class="h-px bg-slate-200 my-4"></div>
         <p class="font-medium">HÃ¬nh áº£nh gá»£i Ã½:</p>${ul(engine.compMax.visuals.map(v=>"ğŸï¸ "+v))}`));

      out.appendChild(sectionCardEl("2", "Hawkeye Narrative â€“ Tá»« tá»•ng thá»ƒ Ä‘áº¿n chi tiáº¿t",
        `<p>${engine.hawkeye.openContext}</p><div class="mt-3">${ul(engine.hawkeye.deepen)}</div>`));

      out.appendChild(sectionCardEl("3", "Visual Examples & Metaphors â€“ áº¨n dá»¥ trá»±c quan",
        ul(engine.metaphors.map(m=>"ğŸ’¡ "+m))));

      out.appendChild(sectionCardEl("4", "Common Ground â€“ Äiá»ƒm chung vá»›i khÃ¡n giáº£",
        `<p>${engine.commonGround.opener}</p><p>${engine.commonGround.we}</p><p>${engine.commonGround.ref}</p>`));

      out.appendChild(sectionCardEl("5", "Simpler Words & Ideas â€“ Ngáº¯n gá»n vÃ  dá»… hiá»ƒu",
        ul(engine.simplify.map(s=>"âœï¸ "+s))));

      out.appendChild(sectionCardEl("6", "Visual Stun Gun â€“ Nhá»‹p hÃ¬nh giá»¯ chÃº Ã½",
        `<p>${engine.visualStun.cadence}</p><div class="mt-2">${ul(engine.visualStun.edits.map(e=>"ğŸ¬ "+e))}</div>`));

      out.appendChild(sectionCardEl("7", "Value Compression â€“ NÃ©n giÃ¡ trá»‹ lÃªn Ä‘áº§u",
        `<p class="font-medium">Trong 10 giÃ¢y Ä‘áº§u:</p>${ul(engine.valueCompression.first10s.map(v=>"âš¡ "+v))}
         <p class="mt-2">CÃ¢u máº«u: <span class="font-semibold">${engine.valueCompression.sample}</span></p>`));

      out.appendChild(sectionCardEl("8", "Come With Proof â€“ ÄÆ°a báº±ng chá»©ng tháº­t",
        `<p>${engine.proof.copy}</p><div class="mt-2">${ul(engine.proof.assets.map(a=>"ğŸ“ "+a))}</div>`));

      out.appendChild(sectionCardEl("9", "Set Up Contrast â€“ Táº¡o tÆ°Æ¡ng pháº£n & báº¥t ngá»",
        `<p>Máº«u cáº¥u trÃºc: ${engine.contrast.template}</p>
         <div class="flex flex-wrap gap-2 mt-3">
           ${engine.contrast.hooks.map(h=>`<span class="px-2 py-1 rounded-full bg-slate-100 text-slate-700 text-xs border border-slate-200">${h}</span>`).join("")}
         </div>`));

      // Outline
      const rows = engine.outline.map(row => `
        <tr class="odd:bg-white even:bg-slate-50">
          <td class="align-top p-3 border-b w-48 font-medium">${row.part}</td>
          <td class="align-top p-3 border-b">${ul(row.content)}</td>
        </tr>
      `).join("");

      out.appendChild(sectionCardEl("ğŸ“œ", "TÃ³m táº¯t ká»‹ch báº£n Ä‘á» xuáº¥t",
        `<div class="overflow-x-auto">
           <table class="w-full text-sm border border-slate-200 rounded-xl overflow-hidden">
             <thead class="bg-slate-50">
               <tr><th class="text-left p-3 border-b">Pháº§n</th><th class="text-left p-3 border-b">Ná»™i dung</th></tr>
             </thead>
             <tbody>${rows}</tbody>
           </table>
         </div>`));

      // Thumb & B-roll
      out.appendChild(sectionCardEl("ğŸ–¼ï¸","Gá»£i Ã½ Thumbnail", ul([
        "TiÃªu Ä‘á» 3â€“5 tá»« máº¡nh: â€˜AI LÃ€ GIA SÆ¯?â€™",
        "áº¢nh chÃ­nh: gÆ°Æ¡ng máº·t cáº£m xÃºc + váº­t thá»ƒ áº©n dá»¥ (Ä‘Ã¨n bÃ n, sÃ¡ch má»Ÿ)",
        "Chá»¯ bá»• trá»£ 2â€“3 tá»«: â€˜Nhanh Gáº¥p 3â€™"
      ])));
      out.appendChild(sectionCardEl("ğŸï¸","Danh sÃ¡ch B-roll Ä‘á» xuáº¥t", ul([
        "BÃ© há»c cÃ¹ng laptop/ChatGPT",
        "Close-up tay gÃµ bÃ n phÃ­m",
        "Biá»ƒu Ä‘á»“ trÆ°á»›c/sau",
        "Giáº¥y khen/Ä‘iá»ƒm sá»‘"
      ])));

      // Openers by tone
      out.appendChild(sectionCardEl("ğŸ™ï¸","Gá»£i Ã½ lá»i thoáº¡i má»Ÿ Ä‘áº§u (theo tÃ´ng giá»ng)",
        ul([
          `<b>Hook tÆ°Æ¡ng pháº£n:</b> "TÃ´i tá»«ng nghÄ© ${engine.topic.toLowerCase()} lÃ  Ã½ tÆ°á»Ÿng tá»‡ â€” cho Ä‘áº¿n khi tháº¥y káº¿t quáº£."`,
          `<b>GiÃ¡ trá»‹ tá»©c thÃ¬:</b> "Trong 60 giÃ¢y, báº¡n sáº½ cÃ³ 3 bÆ°á»›c Ä‘á»ƒ ${engine.goal}."`,
          `<b>Báº±ng chá»©ng lá»“ng ghÃ©p:</b> "ÄÃ¢y lÃ  minh chá»©ng tháº­t tá»« ${engine.audience.toLowerCase()} tuáº§n trÆ°á»›c."`
        ])
      ));
    }

    // --- Initial values & events ---
    const defaults = {
      topic: topicExamples[0],
      audience: audienceExamples[0],
      goal: "giÃºp khÃ¡n giáº£ Ã¡p dá»¥ng Ä‘Æ°á»£c ngay",
      platform: "shorts",
      tone: "Truyá»n cáº£m há»©ng",
      proofAssets: "áº¢nh trÆ°á»›c/sau, Feedback khÃ¡ch hÃ ng, Biá»ƒu Ä‘á»“ káº¿t quáº£"
    };

    function setDefaults() {
      $("topic").value = defaults.topic;
      $("audience").value = defaults.audience;
      $("goal").value = defaults.goal;
      $("platform").value = defaults.platform;
      $("tone").value = defaults.tone;
      $("proofAssets").value = defaults.proofAssets;
      // Fill preset dropdown defaults
      $("topicPreset").value = "";
      $("audiencePreset").value = "";
    }

    function readInput() {
      return {
        topic: $("topic").value.trim() || defaults.topic,
        audience: $("audience").value,
        goal: $("goal").value.trim() || defaults.goal,
        platform: $("platform").value,
        tone: $("tone").value,
        proofAssets: $("proofAssets").value.trim()
      };
    }

    function makeChip(text) {
      const span = document.createElement("span");
      span.className = "inline-flex items-center rounded-full border border-slate-300 px-2.5 py-1 text-xs font-medium text-slate-700 bg-white";
      span.textContent = text;
      return span;
    }

    async function copyJson() {
      const input = readInput();
      const data = buildEngine(input);
      const payload = { input, data, topicExamples, audienceExamples };
      await navigator.clipboard.writeText(JSON.stringify(payload, null, 2));
      alert("ÄÃ£ sao chÃ©p cáº¥u hÃ¬nh + gá»£i Ã½ ra clipboard!");
    }

    $("generateBtn").addEventListener("click", () => {
      const engine = buildEngine(readInput());
      renderAll(engine);
      window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
    });

    $("resetBtn").addEventListener("click", () => {
      setDefaults();
      $("results").innerHTML = "";
      $("chips").innerHTML = "";
    });

    $("copyJsonBtn").addEventListener("click", copyJson);

    // Preset apply handlers
    $("applyTopicPreset").addEventListener("click", () => {
      const val = $("topicPreset").value;
      if (val) $("topic").value = val;
    });
    $("applyAudiencePreset").addEventListener("click", () => {
      const val = $("audiencePreset").value;
      if (val) $("audience").value = val;
    });

    // Boot
    setDefaults();
  </script>
</body>
</html>
